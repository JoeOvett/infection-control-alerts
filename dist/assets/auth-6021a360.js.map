{"version":3,"file":"auth-6021a360.js","sources":["../../src/auth.js"],"sourcesContent":["document.addEventListener('DOMContentLoaded', () => {\r\n    const loginForm = document.querySelector('.login-form');\r\n    const restrictedContent = document.getElementById('restricted-content');\r\n\r\n    // Function to check if the user is logged in\r\n    function isLoggedIn() {\r\n        return !!localStorage.getItem('isLoggedIn');  // Simple check for login state\r\n    }\r\n\r\n    // Set the display style of the restricted content if it exists and the user is logged in\r\n    if (isLoggedIn() && restrictedContent) {\r\n        restrictedContent.style.display = 'flex';\r\n    }\r\n\r\n    // Handle the login form submission\r\n    if (loginForm) {\r\n        loginForm.addEventListener('submit', function(event) {\r\n            event.preventDefault(); // Prevent default form submission\r\n            const formData = new FormData(loginForm);\r\n            const email = formData.get('email');\r\n            const password = formData.get('password');\r\n            \r\n            fetch('https://jo435.brighton.domains/ci601/login.php', {\r\n                method: 'POST',\r\n                credentials: 'include', // Necessary for cookies to be sent and received\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify({ email, password })\r\n            })\r\n            .then(response => response.json())\r\n            .then(data => {\r\n                if (data.success) {\r\n                    console.log('Login successful');\r\n                    localStorage.setItem('isLoggedIn', true); // Set login state\r\n                    // Optionally set the restricted content to display if login is processed on the same page\r\n                    if (restrictedContent) {\r\n                        restrictedContent.style.display = 'flex';\r\n                    }\r\n                    window.location.href = 'https://infection-control-alerts.vercel.app'; // Redirect\r\n                } else {\r\n                    console.error('Login failed', data.message);\r\n                    document.querySelector('.error-message').textContent = data.message;\r\n                    document.querySelector('.error-message').style.display = 'block';\r\n                }\r\n            })\r\n            .catch(error => {\r\n                console.error('Error:', error);\r\n                document.querySelector('.error-message').textContent = 'Login failed due to a network error.';\r\n                document.querySelector('.error-message').style.display = 'block';\r\n            });\r\n        });\r\n    }\r\n});\r\n"],"names":["loginForm","restrictedContent","isLoggedIn","event","formData","email","password","response","data","error"],"mappings":"AAAA,SAAS,iBAAiB,mBAAoB,IAAM,CAChD,MAAMA,EAAY,SAAS,cAAc,aAAa,EAChDC,EAAoB,SAAS,eAAe,oBAAoB,EAGtE,SAASC,GAAa,CAClB,MAAO,CAAC,CAAC,aAAa,QAAQ,YAAY,CAC7C,CAGGA,EAAY,GAAID,IAChBA,EAAkB,MAAM,QAAU,QAIlCD,GACAA,EAAU,iBAAiB,SAAU,SAASG,EAAO,CACjDA,EAAM,eAAc,EACpB,MAAMC,EAAW,IAAI,SAASJ,CAAS,EACjCK,EAAQD,EAAS,IAAI,OAAO,EAC5BE,EAAWF,EAAS,IAAI,UAAU,EAExC,MAAM,iDAAkD,CACpD,OAAQ,OACR,YAAa,UACb,QAAS,CACL,eAAgB,kBACnB,EACD,KAAM,KAAK,UAAU,CAAE,MAAAC,EAAO,SAAAC,CAAQ,CAAE,CACxD,CAAa,EACA,KAAKC,GAAYA,EAAS,MAAM,EAChC,KAAKC,GAAQ,CACNA,EAAK,SACL,QAAQ,IAAI,kBAAkB,EAC9B,aAAa,QAAQ,aAAc,EAAI,EAEnCP,IACAA,EAAkB,MAAM,QAAU,QAEtC,OAAO,SAAS,KAAO,gDAEvB,QAAQ,MAAM,eAAgBO,EAAK,OAAO,EAC1C,SAAS,cAAc,gBAAgB,EAAE,YAAcA,EAAK,QAC5D,SAAS,cAAc,gBAAgB,EAAE,MAAM,QAAU,QAE7E,CAAa,EACA,MAAMC,GAAS,CACZ,QAAQ,MAAM,SAAUA,CAAK,EAC7B,SAAS,cAAc,gBAAgB,EAAE,YAAc,uCACvD,SAAS,cAAc,gBAAgB,EAAE,MAAM,QAAU,OACzE,CAAa,CACb,CAAS,CAET,CAAC"}