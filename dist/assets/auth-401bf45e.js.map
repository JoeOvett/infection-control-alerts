{"version":3,"file":"auth-401bf45e.js","sources":["../../src/auth.js"],"sourcesContent":["document.addEventListener(\"DOMContentLoaded\", function() {\r\n    const token = getCookie(\"token\");\r\n    console.log(\"JWT from cookie: \", token); // Log the token\r\n\r\n    if (!token) {\r\n        console.log(\"No token found, redirecting to login.\");\r\n        window.location.href = \"https://jo435.brighton.domains/ci601/login.php\";\r\n    } else {\r\n        // Attempt to access a protected route to verify token\r\n        fetch('https://jo435.brighton.domains/protected', {\r\n            method: 'GET',\r\n            credentials: 'include' // to send cookies that contain the JWT\r\n        })\r\n        .then(response => {\r\n            console.log(\"Response status: \", response.status);\r\n            if (response.ok) {\r\n                console.log(\"Token is valid, showing restricted content.\");\r\n                document.getElementById(\"restricted-content\").style.display = 'block';\r\n            } else {\r\n                throw new Error('Not authorized');\r\n            }\r\n        })\r\n        .catch(error => {\r\n            console.error('Authentication error:', error);\r\n            window.location.href = \"https://jo435.brighton.domains/ci601/login.php\";\r\n        });\r\n    }\r\n});\r\n\r\nfunction getCookie(name) {\r\n    const value = `; ${document.cookie}`;\r\n    const parts = value.split(`; ${name}=`);\r\n    return parts.length === 2 ? parts.pop().split(\";\").shift() : null;\r\n}\r\n"],"names":["token","getCookie","response","error","name","parts"],"mappings":"AAAA,SAAS,iBAAiB,mBAAoB,UAAW,CACrD,MAAMA,EAAQC,EAAU,OAAO,EAC/B,QAAQ,IAAI,oBAAqBD,CAAK,EAEjCA,EAKD,MAAM,2CAA4C,CAC9C,OAAQ,MACR,YAAa,SACzB,CAAS,EACA,KAAKE,GAAY,CAEd,GADA,QAAQ,IAAI,oBAAqBA,EAAS,MAAM,EAC5CA,EAAS,GACT,QAAQ,IAAI,6CAA6C,EACzD,SAAS,eAAe,oBAAoB,EAAE,MAAM,QAAU,YAE9D,OAAM,IAAI,MAAM,gBAAgB,CAEhD,CAAS,EACA,MAAMC,GAAS,CACZ,QAAQ,MAAM,wBAAyBA,CAAK,EAC5C,OAAO,SAAS,KAAO,gDACnC,CAAS,GApBD,QAAQ,IAAI,uCAAuC,EACnD,OAAO,SAAS,KAAO,iDAqB/B,CAAC,EAED,SAASF,EAAUG,EAAM,CAErB,MAAMC,EADQ,KAAK,SAAS,MAAM,GACd,MAAM,KAAKD,CAAI,GAAG,EACtC,OAAOC,EAAM,SAAW,EAAIA,EAAM,MAAM,MAAM,GAAG,EAAE,MAAK,EAAK,IACjE"}